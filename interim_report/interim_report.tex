\documentclass{article} 
\usepackage{geometry}
\geometry{legalpaper, portrait, margin=1in}
\usepackage{fancyhdr}
\usepackage{enumerate}
\usepackage{listings}
\usepackage{amsmath}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{graphicx}
\usepackage{hyperref}
\graphicspath{ }

\title{OpenFlow-based Adaptive Routing for Wireless Networks}
\author{
    Alok Kulkarni \\
    \textit{akulkar4@ncsu.edu}
    \and
    Angelyn Arputha Babu John \\
    \textit{ababujo@ncsu.edu}
    \and
    Jignesh Darji \\
    \textit{jndarji@ncsu.edu}
    \and 
    Nishad Sabnis \\
    \textit{nsabnis@ncsu.edu}
}
\date{
    \small{\url{https://sites.google.com/a/ncsu.edu/openflow-based-adaptive-routing-for-wireless-networks}}\\
    November 5th, 2015}

\pagestyle{fancy}
\fancyhf{}
\rhead{OpenFlow-based Adaptive Routing for Wireless Networks}
\lhead{CSC573}
\rfoot{Page \thepage}

\begin{document}
\maketitle
\section{Introduction}
\subsection{Problem Statement}
Designing a system to enable adaptive routing in a wireless network in order to make a comparative analysis of the
throughput efficiency of ground nodes versus aerial nodes.
\subsection{Problem Description}
\par We aim to implement OpenFlow based adaptive routing in an ad-hoc network by monitoring the link quality between wireless
nodes. We anticipate that in such a network which offers multiple wireless routes between two end-points, the
fluctuations in the RF link qualities between the endpoints will play an important role in determining the best end to
end path. Determining the wireless link quality between each and every inter-connected node and making routing decisions
based on this information constitute the two major parts of the problem. 
\par We plan to make aerial nodes a part of the network which will be used for testing. Aerial nodes have their own set of
advantages and disadvantages. They are less susceptible to electromagnetic interferences and can beam wifi over a large
area if the antennae are powerful enough. However, the number of aerial nodes and naturally the number of available
links through such nodes is likely to be lesser due to the low prevalence of such nodes. These trade offs need to be
accounted for while making the routing decisions as well. The final aim is to ensure that the flow tables are
dynamically modified to ensure effective end to end packet transmission. 
\section{Components}
\subsection{Platforms for the project}
\begin{itemize}
\item OpenFlow v1.3
\item Ubuntu
\item SDN Controller
\end{itemize}
\subsection{Areas for the project}
\begin{itemize}
\item Link Quality Monitoring
\item Adaptive Routing
\end{itemize}
\subsection{Major Components}
\subsubsection{Wireless Ground Nodes}
The ground nodes will be laptops. They will have the following features:
\begin{itemize}
\item At least one wireless interface
\item At least one interface to connect to the host
\item Open vSwitch module installed
\item One of the ground nodes will be the controller
\end{itemize}
\subsubsection{Aerial Nodes}
The aerial nodes will have the capacity to go up till 30 feet and beem signals from above. The key features of the
aerial nodes are:
\begin{itemize}
\item At least one wireless interface
\item BeagleBone black Linux boards
\item Open vSwitch kernel module installed
\end{itemize}
\subsubsection{Software Components}
The software components will help determine the link quality and the optimum path, and they will configure the network
with the optimal path.
\begin{itemize}
\item Link Quality Information module
\item OpenFlow Control module
\end{itemize}
\section{Design}
\subsection{Overview}
\begin{figure}[H]
\caption{Design Overview}
\centering
\includegraphics[width=\textwidth]{design}
\end{figure}
The above figure describes the overview of the components constituting this system. There exists a wireless ad-hoc
network of aerial and ground nodes. One of the nodes acts as an SDN controller and the others act as agents. A link
quality information (LQI) module is running on all the nodes in the network and this information is forwarded to the
OpenFlow controller which makes adaptive routing decisions. The controller will use this information to compute the
optimum end-to-end route between the endpoints. These routes will then be configured into the nodes using OpenFlow. The
nodes will have OVS running on them which will configure the routes sent by the Controller. 
\subsection{Link Quality Information Module}
\begin{figure}[H]
\caption{Components in the Link Quality Information Module}
\centering
\includegraphics[width=\textwidth]{lqi}
\end{figure}
This module is responsible for estimating the point-to-point link quality between nodes. It will run on all the nodes in
the topology and give a periodically updated link quality estimate to the SDN controller. This information can then be
used by the SDN controller to update the topology and find the optimal path. The module is made up of two units: 
\begin{itemize}
\item \textit{Request unit}: It sends out the UDP broadcast and receives the responses for these broadcasts (Packet Broadcaster, Response Handler).
\item \textit{Response unit}: It receives the UDP broadcast and responds to it (Broadcast Receiver, Broadcast Responder).
\end{itemize}
\subsubsection{Packet Broadcaster} 
The LQI packet broadcaster will send out a UDP broadcast on the ad-hoc network. The broadcast is directed at a specific
UDP port to differentiate it from normal UDP traffic. The packet broadcaster will send out a broadcast packet after a 10
second interval. The UDP frame will look as follows:
%TODO: Add frame
\begin{figure}[H]
\centering
\includegraphics[width=\textwidth]{packet_broadcaster}
\end{figure}
\subsubsection{Broadcast Receiver}
Will listen on a specific port for LQI Hello packets and trigger the Broadcast Responder once it has verified the frame
format for each. 
\subsubsection{Broadcast Responder} 
Will prepare a unicast response for the broadcast source. The response will be sent out to a specific UDP port and will
have the following format. %TODO: Adding frame
\begin{figure}[H]
\centering
\includegraphics[width=\textwidth]{broadcast_responder}
\end{figure}
\subsubsection{Response Handler} 
The LQI Response Handler will listen at a specific port for any LQI responses, parse the LQI packet for obtaining the
SSI, source and destination IP and MAC, and forward the packet to the LQI calculator. The module will have a timeout
within which it expects to receive all the responses and will update the LQI Calculator after the timeout. The radiotap
header (LINKTYPE\_IEEE802\_11\_RADIOTAP) is an alternative to the normal 802.11 header (LINKTYPE\_IEEE802\_11) and and
contains some extra information about the wireless network along with the normal 802.11 header. The radiotap header
itself consists of a set of defined fields from which antenna signal (SSI) is to be extracted. The position of the
Radiotap header in the frame is as shown below. 
%TODO: Frame
\begin{figure}[H]
\centering
\includegraphics[width=\textwidth]{response_handler}
\end{figure}
\subsubsection{LQI Calculator} 
This module will get the SSI, source and destination IP and MAC address values from the Response Handler for all the
responses it receives. These value will be converted and stored in an LQI table in a format which can be further sent to
the controller.
\subsubsection{LQI to Control Updater} 
This module will refer to the values stored by the Calculator in LQI information table and prepare a payload that will
be sent to the controller. This packet will be used by the controller to create a topology and find the optimal path.
The format of the payload is as follows:
%TODO: Frame
\begin{figure}[H]
\centering
\includegraphics[width=\textwidth]{lqi_to_control_updater}
\end{figure}
\subsection{OpenFlow Control Module}
\begin{figure}[H]
\caption{Components in the OpenFlow Control application}
\centering
\includegraphics[width=\textwidth]{openflow}
\end{figure}
\subsubsection{Topology Modifier(TM)}
\textit{Function}: Generate and maintain the topology of the network and intimate Optimal Path Finder about topology change.
\begin{itemize}
\item Topology Construction: TM module accept the LQI messages and constructs the adjacency lists for all the nodes in
the network. The node data structure will contain following information be as follows:
\begin{itemize}
\item Node IP
\item Node MAC
\item Adjacent Nodes(IP and MAC) along with cost to reach them
\end{itemize}
\item \textit{Node Removal}: For each node, we shall have a running timer. If we do not get ‘N’ consecutive LQI messages from a
node, we shall remove the node from the topology. Calculation of N will be done later. We cannot have a high N because
the network convergence time would be affected. We cannot keep it low because that will mean a lot of reconfigurations
by the Network Updater if the node was not out of network or down but it’s LQI messages were dropped for a transient
duration due to other factors.
\item \textit{Topology Updates}: The TM module will be invoked to update the topology when one of the following event occurs in
the network:
\begin{itemize}
\item \textit{Node Addition}: When a node is added, it will be added to the adjacency list and cost to reach it from other nodes,
and costs from that new node to other nodes need to be updated.
\item \textit{Node Removal}: When a node is removed from the network(See “Node Removal” above), we need to remove its entry.
\item \textit{Cost Updates}: When the LQI message from a node is received with different costs, the adjacency list of that node
shall be update.
\end{itemize}
\item \textit{Callback to Optimal Path Finder}: When the topology is updated, it will send a callback to the OPF module.
\end{itemize}
\subsubsection{Optimal Path Finder(OPF)}
\textit{Function}: Find the lowest cost path between the end hosts.
\begin{itemize}
\item \textit{Limited Paths}: Since the topology is limited - 4 nodes and 2 of them connect to the end hosts - we have limited
end-to-end paths between the 2 edge nodes.
\begin{figure}[H]
\caption{Paths between edge nodes}
\centering
\includegraphics[width=\textwidth]{OPF_paths}
\end{figure}
\item \textit{Path Selection}: OPF will calculate path costs for all the 4 paths and select the least cost path.
\item \textit{Callback to Network Updater}: If the new path is different from the previous path, we send a callback to
the Network Updater.
\end{itemize}
\subsubsection{Network Updater(NU)}
\begin{itemize}
\item \textit{Problem}: Since the network is wireless ad-hoc and all the nodes can generally connect to each other, the
destination node will accept the packet directly. We need to enforce a method so that the packet follows the optimal
path calculated by the OPF and not the direct path between edge nodes.
\item \textit{Algorithm}: 
\begin{itemize}
\item \textit{Edge Nodes}: Install single rule on edge nodes to modify the DST\_MAC to it’s next node’s MAC. Here, next
node is the adjacent node in the optimal path.
\item \textit{Internal Nodes}: Install two rules on internal nodes to modify the DST\_MAC as well as SRC\_MAC for both the
directions. A simple illustration will clarify this step. 
\end{itemize}
\item \textit{Example}: In the below illustration, the edge nodes are A and D and the optimal path is A-B-D. To enforce
forwarding along A->B->D through the optimal path, A sends to B by changing the DST\_MAC to B’s MAC and then B sends to D
by changing the DST\_MAC to D’s MAC and SRC\_MAC to B’s MAC. Similar rules on D and B are required to enable for D->B->A. 
\end{itemize}
\begin{figure}[H]
\caption{Flow Rule Illustration}
\centering
\includegraphics[width=\textwidth]{NU_Algorithm_Example}
\end{figure}

\section{Per-member Responsibilities}
\begin{tabular}{ | p{0.185\linewidth} | p{0.185\linewidth} | p{0.185\linewidth} | p{0.185\linewidth} | p{0.185\linewidth} | }
\hline
\textbf{Tasks}	&	\textbf{Angelyn Arputha Babu John}	&	\textbf{Jignesh Darji}	&	\textbf{Nishad Sabnis}	& \textbf{Alok Kulkarni} \\
\hline \hline
Node Setup	&	Implement	&	Implement	&	Implement	&	Implement \\
\hline
Creation of ad-hoc network	&	Review	&	Review	&	Implement	&	Implement \\
\hline
LQI Message Handling	&	Review	&	Review	&	Implement	&	Implement \\ 
\hline
LQI Calculator	&	Review	&	Review	&	Review	&	Implement\\ 
\hline
LQI to Control Updater	&	Review	&	Review	&	Implement	&	Review \\
\hline
Topology Modifier	&	Implement	&	Implement	&	Review	&	Review\\
\hline
Optimal Path Finder	&	Implement	&	Implement	&	Review	&	Review\\
\hline
Network Updater	&	Implement	&	Implement	&	Review	&	Review\\
\hline
\end{tabular}

\section{Test Plan}
\begin{tabular}{  | p{0.185\linewidth} | p{0.185\linewidth} | p{0.185\linewidth} | p{0.185\linewidth} | p{0.185\linewidth} |}
\hline
\textbf{Test}	&	\textbf{LQI Module}	&	\textbf{Topology Modifier(TM)}	&	\textbf{Optimal Path Finder (OPF)}	&
\textbf{Network Updater(NU)}\\ 
\hline \hline
Add a node with low path cost	&	Connected nodes should transmit cost with the new node to the LQI messages	&	Add node to Topology; intimate OPF	&	Add to Network Model; intimate NU	&	Update affected nodes\\ 
\hline
Add a node with high path cost	&	Connected nodes should transmit cost with the new node to the LQI messages	&	Add node to Topology; intimate OPF	&	Network Model remains same	&	NA\\ 
\hline
Remove node from Network Model	&	LQI messages will not contain costs to this node	&	Remove node from Topology; intimate OPF	&	Modifies Network Model; intimate NU	&	Update affected nodes\\ 
\hline
Remove node not part of Network Model	&	LQI messages will not contain costs to this node	&	Remove node from Topology; intimate OPF	&	Network Model remains same	&	NA\\ 
\hline
Increase associated path cost of a node in Network Model	&	Cost to this node should be increased in the LQI messages	&	Update path costs in Topology; intimate OPF	&	Modifies Network Model; intimate NU	&	Update affected nodes\\ 
\hline
Increase associated path cost of a node NOT in Network Model	&	Cost to this node should be increased in the LQI messages	&	Update path costs in Topology; intimate OPF	&	Network Model remains same	&	NA\\ 
\hline
Decrease associated path cost of a node in Network Model	&	Cost to this node should be decreased in the LQI messages	&	Update path costs in Topology; intimate OPF	&	Network Model remains same	&	NA\\ 
\hline
Decrease associated path cost of a node NOT in Network Model	&	Cost to this node should be decreased in the LQI messages	&	Update path costs in Topology; intimate OPF	&	Modifies Network Model; intimate NU	&	Update affected nodes \\
\hline
\end{tabular}
\section{Demo Plan}
\begin{enumerate}
\item Once the ad-hoc network is setup, the controller will generate the Network Model and configure the rules in all
the nodes for the optimal path.
\item A display utility for the Network Model will print the current Network Model.
\item We'll display that these rules have been correctly configured in the nodes by connecting to each node and
displaying their rule tables.
\item Thus, on changing the distance between the nodes, we plan to show that the routes between the two endpoints change
dynamically based on the link strength. 
\end{enumerate}
\end{document}
